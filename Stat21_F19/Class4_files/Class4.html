<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <title>Class 4</title>
    <meta charset="utf-8" />
    <meta name="author" content="Suzanne Thornton" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/default-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Class 4
## STAT 021
### Suzanne Thornton
### Swarthmore College
### 2019/9/9 (updated: 2019-09-12)

---




&lt;style type="text/css"&gt;
pre {
  background: #FFBB33;
  max-width: 100%;
  overflow-x: scroll;
}
&lt;/style&gt;




&lt;img src="Figs/correlation.png" style="display: block; margin: auto;" /&gt;

.footnote[Source: https://xkcd.com/2029/]

---

# Topics covered in today's lecture

  - Data manipulation in R *tidyverse* 
  - Answering statistical questions about the body temperature data
  - Determining normality 
  - Introduction to R Markdown available on Moodle (more material to come later today)

---
# A new data set - body temperature


```r
rm(list = ls())
#install.packages("tidyverse") ##should also install the dependencies "ggplot2" (for visualizing data) and "margrittr" (for piping)
library("tidyverse")
setwd("~/Dropbox/z MyStuff Dropbox/Swat docs/Stat 21/Class2_files")
read_table2("normtemp_data.txt") 
```

```
## # A tibble: 130 x 3
##    Temperature Handedness HeartRate
##          &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;
##  1        96.3          1        70
##  2        96.7          1        71
##  3        96.9          1        74
##  4        97            1        80
##  5        97.1          1        73
##  6        97.1          1        75
##  7        97.1          1        82
##  8        97.2          1        64
##  9        97.3          1        69
## 10        97.4          1        70
## # … with 120 more rows
```

---
# Body temperature data


```
## # A tibble: 130 x 3
##    Temperature Handedness HeartRate
##          &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;
##  1        96.3          1        70
##  2        96.7          1        71
##  3        96.9          1        74
##  4        97            1        80
##  5        97.1          1        73
##  6        97.1          1        75
##  7        97.1          1        82
##  8        97.2          1        64
##  9        97.3          1        69
## 10        97.4          1        70
## # … with 120 more rows
```


All of the columns were imported as type "double". Is this what we want?


.footnote[https://magazine.amstat.org/blog/2019/03/01/evolutionofvariables/]


---
# Body temperature data

Now we can create a data "object" which we will call *body_temp_dat*.


```r
body_temp_dat &lt;- read_table2("normtemp_data.txt", 
                        col_types = list(col_double(),col_character(),col_double()))
body_temp_dat %&gt;% head() 
```

```
## # A tibble: 6 x 3
##   Temperature Handedness HeartRate
##         &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;
## 1        96.3 1                 70
## 2        96.7 1                 71
## 3        96.9 1                 74
## 4        97   1                 80
## 5        97.1 1                 73
## 6        97.1 1                 75
```

---
# Useful ways to manipulate data&lt;sup&gt;1&lt;/sup&gt;

Commonly used data manipulation functions
  - *select()*
  - *filter()*
  - *mutate()*
  - *group_by()*
  - *summarize()*
  - *count()* 

  
.footnote[1 https://datacarpentry.org/R-ecology-lesson/03-dplyr.html#selecting_columns_and_filtering_rows]  

---
# Useful ways to manipulate data

These R functions are helpful with cleaning and organizing data, especially when some data are missing.  


```r
#To select specific columns:
    body_temp_dat %&gt;% select(Temperature, HeartRate)
```

```
## # A tibble: 130 x 2
##    Temperature HeartRate
##          &lt;dbl&gt;     &lt;dbl&gt;
##  1        96.3        70
##  2        96.7        71
##  3        96.9        74
##  4        97          80
##  5        97.1        73
##  6        97.1        75
##  7        97.1        82
##  8        97.2        64
##  9        97.3        69
## 10        97.4        70
## # … with 120 more rows
```

---
# Useful ways to manipulate data

These R functions are helpful with cleaning and organizing data, especially when some data are missing.  


```r
    #...or equivalently
    body_temp_dat %&gt;% select(-Handedness)
```

```
## # A tibble: 130 x 2
##    Temperature HeartRate
##          &lt;dbl&gt;     &lt;dbl&gt;
##  1        96.3        70
##  2        96.7        71
##  3        96.9        74
##  4        97          80
##  5        97.1        73
##  6        97.1        75
##  7        97.1        82
##  8        97.2        64
##  9        97.3        69
## 10        97.4        70
## # … with 120 more rows
```

---
# Useful ways to manipulate data

These R functions are helpful with cleaning and organizing data, especially when some data are missing.  


```r
#To select specific rows:    
    body_temp_dat %&gt;% filter(Handedness==1)
```

```
## # A tibble: 65 x 3
##    Temperature Handedness HeartRate
##          &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;
##  1        96.3 1                 70
##  2        96.7 1                 71
##  3        96.9 1                 74
##  4        97   1                 80
##  5        97.1 1                 73
##  6        97.1 1                 75
##  7        97.1 1                 82
##  8        97.2 1                 64
##  9        97.3 1                 69
## 10        97.4 1                 70
## # … with 55 more rows
```

---
# Useful ways to manipulate data

These R functions are helpful with cleaning and organizing data, especially when some data are missing.  


```r
#Combine types of selection
    body_temp_dat %&gt;% filter(Handedness==1) %&gt;% 
                      select(-Handedness)
```

```
## # A tibble: 65 x 2
##    Temperature HeartRate
##          &lt;dbl&gt;     &lt;dbl&gt;
##  1        96.3        70
##  2        96.7        71
##  3        96.9        74
##  4        97          80
##  5        97.1        73
##  6        97.1        75
##  7        97.1        82
##  8        97.2        64
##  9        97.3        69
## 10        97.4        70
## # … with 55 more rows
```

---
# Useful ways to manipulate data

The *mutate()* function allows you to append a new column of data to your original data set. 


```r
  body_temp_dat %&gt;% filter(Handedness==2) %&gt;%
                    mutate(CelciusTemp = ((Temperature-32)*5)/9)
```

```
## # A tibble: 65 x 4
##    Temperature Handedness HeartRate CelciusTemp
##          &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;       &lt;dbl&gt;
##  1        96.4 2                 69        35.8
##  2        96.7 2                 62        35.9
##  3        96.8 2                 75        36  
##  4        97.2 2                 66        36.2
##  5        97.2 2                 68        36.2
##  6        97.4 2                 57        36.3
##  7        97.6 2                 61        36.4
##  8        97.7 2                 84        36.5
##  9        97.7 2                 61        36.5
## 10        97.8 2                 77        36.6
## # … with 55 more rows
```

---
# Useful ways to manipulate data

The *group_by()* function groups the data according to different "levels" of a categorical variable of your choice. 


```r
  body_temp_dat %&gt;% group_by(Handedness) %&gt;%
                    summarize(mean_temp = mean(Temperature),
                              standard_dev_temp = sd(Temperature))
```

```
## # A tibble: 2 x 3
##   Handedness mean_temp standard_dev_temp
##   &lt;chr&gt;          &lt;dbl&gt;             &lt;dbl&gt;
## 1 1               98.1             0.699
## 2 2               98.4             0.743
```


---
# Useful ways to manipulate data

The *count()* function provides a table of the total number of individuals within each group of a categorical variable of your choice. 


```r
  body_temp_dat %&gt;% count(Handedness)
```

```
## # A tibble: 2 x 2
##   Handedness     n
##   &lt;chr&gt;      &lt;int&gt;
## 1 1             65
## 2 2             65
```


---
# Why are we using piping?

It is very useful when you need to apply many different transformations to your data and don’t want to save the intermediate results or have many opening and closing function parentheses. It is also very useful for cleaning data.

For example, suppose we want to compute the logarithm of the vector `x`, then find the differences between each element and it's subsequent element, then compute the exponential function value of these difference, and finally, round the result to one decimal point. 

```r
x &lt;- c(0.109, 0.359, 0.63, 0.996, 0.515, 0.142, 0.017, 0.829, 0.907)

round(exp(diff(log(x))), 1)
```

```
## [1]  3.3  1.8  1.6  0.5  0.3  0.1 48.8  1.1
```

---
# Why are we using piping?

Or you can do the same operations much neater using pipes:

```r
x %&gt;% log() %&gt;%
    diff() %&gt;%
    exp() %&gt;%
    round(1)
```

```
## [1]  3.3  1.8  1.6  0.5  0.3  0.1 48.8  1.1
```

Which one is easier to read? Which one is easier for other people (the people who didn't write your code) to read? 

---
# Visualizing data in R with *ggplot2*

Does the data look normally distributed? 



```r
body_temp_plot &lt;- ggplot(data=body_temp_dat, aes(Temperature)) 
                         
p1 &lt;- body_temp_plot + geom_histogram()  
p2 &lt;- body_temp_plot + geom_density()

#install.packages("cowplot") ##requires R version &gt;= 3.5.0  
library("cowplot")
plot_grid(p1, p2, align = "h", nrow = 1, rel_widths = c(1/2, 1/2))
```

&lt;img src="Figs/figDensityClass4-1.png" style="display: block; margin: auto;" /&gt;


---
# The most useful statistical summaries 

Measure of "location"
  
  - Mean: sometimes this does not exist! 
  
  - Median
  
  - Mode
  
  - Plots! 
  
Measures of "spread" (or "scale") 
  
  - Standard deviation: sometimes this is infinite! (e.g. Cauchy distribution)
  
  - Interquartile range
  
  - Minimum and maximum
  
  - Plots! 


---

# Variance and standard deviation 

  - Standard deviation is a *standard* unit of measurement for Statisticians. Always specify, the standard deviation *of what?*. Otherwise, we have no idea what kind of data we are studying since standard deviation is unit-less! 

  - Variance is just a function of standard deviation. The same rules apply.

  - Standard error is a related concept; it is the standard deviation of the **estimate** for the parameter of interest.&lt;sup&gt;[1]&lt;/sup&gt; 

--


Standard error gives us a measurement of uncertainty about a parameter and thus is used in constructing confidence intervals for that parameter. 

Standard deviation on the other hand is a property of the data. 

.footnote[[1] https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3148365/
]


---
# Analyze body temp data

  Is the true population mean really 98.6 degrees F? 
  

```r
body_temp_plot + geom_density() + 
                 geom_vline(xintercept=98.6, col="red")
```

&lt;img src="Figs/fig_ttest-1.png" style="display: block; margin: auto;" /&gt;


---
# Analyze body temp data

For fun: what does a Cauchy density (green) look like in comparison to the data (black) or to a normal density (blue)? (Remember the Cauchy distribution has no finite mean or standard deviation.) 

&lt;img src="Figs/fig_bell_distbns-1.png" style="display: block; margin: auto;" /&gt;


---
# Analyze body temp data

  Is the true population mean really 98.6 degrees F? 
  

```r
    t.test(body_temp_dat$Temperature, alternative="two.sided", mu=98.6, conf.level=0.95)
```

```
## 
## 	One Sample t-test
## 
## data:  body_temp_dat$Temperature
## t = -5.4548, df = 129, p-value = 2.411e-07
## alternative hypothesis: true mean is not equal to 98.6
## 95 percent confidence interval:
##  98.12200 98.37646
## sample estimates:
## mean of x 
##  98.24923
```

---
# Analyze body temp data

At what temperature should we consider someone's temperature to be "abnormal"? 
--


To answer this question, we need a measurement of deviation for the temperature data. 


```r
sd(body_temp_dat$Temperature)
```

```
## [1] 0.7331832
```

```r
var(body_temp_dat$Temperature)
```

```
## [1] 0.5375575
```
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
