<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Class 4 - Part 1</title>
    <meta charset="utf-8" />
    <meta name="author" content="STAT 021 with Suzanne Thornton" />
    <link href="class4-part1_files/remark-css/default.css" rel="stylesheet" />
    <link href="class4-part1_files/remark-css/default-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Class 4 - Part 1
## Two-sample T-tests for the Difference in Population Means
### STAT 021 with Suzanne Thornton
### Swarthmore College
### For class on Thursday, Sept 17, 2020 (updated: 2020-09-14)

---




&lt;style type="text/css"&gt;
pre {
  background: #FFBB33;
  max-width: 100%;
  overflow-x: scroll;
}

.scroll-output {
  height: 70%;
  overflow-y: scroll;
}

.scroll-small {
  height: 50%;
  overflow-y: scroll;
}
   
.red{color: #ce151e;}
.green{color: #26b421;}
.blue{color: #426EF0;}
&lt;/style&gt;


## Difference in means  
### Problem Set-up

Just as we were able to determine if there is a statistically significant difference between two population proportions, we are now going to do the same for two populations with quantitative variables of interest. The question that we are interested in now is: "Is there a statistically significant difference between the mean values of these two RVs?" 


.pull-left[**Option 1:** Un-paired samples

In this setting, we have two independent simple random samples from two populations (e.g. comparing the SAT scores of public versus private high schools). The two samples may or may not have the same sample size.] 
.push-right[**Option 2:** Paired sample 

In this setting, we have two samples but they are from the same population (e.g. we may be studying genetic traits across twins or test scores of the same people before and after attending a workshop on test-taking strategies). The samples will always be the same size in this setting.]

&amp;nbsp;
&amp;nbsp;
--

.center[The key to understanding the differences between these settings is to think about the variation between the two samples. If the samples are from different populations, then the values that the quantitative variables take on probably varies a lot more than if they were samples from the sample population.]   

---
## Option 1 - Un-paired samples, difference in means  
### Problem Set-up


**Population:** 

If we have two samples from different populations, we can consider the quantitative RVs as *two, independent* continuous RVs, `\(X_1\)` and `\(X_2\)`. The *population parameter* we are interested in is `\(\mu_1-\mu_2\)`: the difference between the two population means,

`$$\mu_1 = E[X_1] = \sum_{x \in S_1} xPr(X_1=x), \text{ and } \mu_2 = E[X_2] = \sum_{x \in S_2} xPr(X_2=x),$$`
where `\(S_1\)` and `\(S_2\)` are the sample spacers of all possible values `\(X_1\)` and `\(X_2\)` might take, respectively.

**Sample:** Two .blue[independent] random subsets, one from each population 

`\begin{align}
x_{1, obs} &amp;=&amp; \{x_{1,1}, x_{1,2}, x_{1,3}, \dots, x_{1,n_1}\} \text{ and}\\
x_{2, obs} &amp;=&amp; \{x_{2,1}, x_{2,2}, \dots, x_{2,n_2}\} 
\end{align}`

**Sample size:** `\(n_1=\)` the number of observational units in the first sample; `\(n_2=\)` the number of observational units in the second sample  


---
## Option 1 - Un-paired samples, difference in means  
### Problem Set-up


With our two samples, we now have an **estimate** for the parameter of interest `\(\mu_1-\mu_2\)`: 
`$$\bar{X}_1 - \bar{X}_2 = \frac{1}{n_1}\sum_{i=1}^{n_1}x_{1,i} - \frac{1}{n_2}\sum_{j=1}^{n_2}x_{2,j}.$$`

We also know that for RVs, `\(X\)` and `\(Y\)`, `\(Var(X-Y) = Var(X) + Var(Y) - 2Cov(X,Y)\)` and that if `\(X\)` and `\(Y\)` are independent, then `\(Cov(X,Y)=0\)`. This means that if we consider `\(\bar{X}_1\)` and `\(\bar{X}_2\)` as independent RVs with their own sampling distributions, then 
`$$Var(\bar{X}_1 - \bar{X}_2) = Var(\bar{X}_1) + Var(\bar{X}_2) + 0 = \frac{\sigma_1^2}{n_1} + \frac{\sigma_2^2}{n_2},$$`
where `\(\sigma_1^2\)` is the unknown variance for `\(X_1\)` over the first population and `\(\sigma_2^2\)` is the same but for the second population. 

---
## Option 1 - Un-paired samples, difference in means  
### Problem Set-up


With our two samples, we now have an **estimate** for the parameter of interest `\(\mu_1-\mu_2\)`: 
`$$\bar{X}_1 - \bar{X}_2 = \frac{1}{n_1}\sum_{i=1}^{n_1}x_{1,i} - \frac{1}{n_2}\sum_{j=1}^{n_2}x_{2,j}.$$`


Naturally, we want to know how close the estimate above is to the parameter of interest. Before we can address this, we must make sure the following **assumptions** are reasonable for *both* samples:  

1. The two populations must be independent of one another. There is no statistical test for this assumption. You must carefully think about any possible dependencies between the two populations before proceeding. 

2. The values the quantitative variables `\(X_1\)` and `\(X_2\)` can take on, follow roughly a symmetric and uni-modal histogram. (Since we aren't able to collect data on the entire population, we typically can only check this assumption with two histograms for both sets of observed values.

3. The data are simple random samples (SRS) from both populations of interest. (Are there any dependencies among the data? Do the samples comprise less than `\(10\%\)` of the populations? Were these samples collected without bias?)


---
## Confidence Intervals 
### Option 1: Un-paired samples 

A `\((1-\alpha)\times100 \%\)` confidence interval for the true (unknown) difference `\(\mu_1-\mu_2\)` is 

`$$(\bar{X}_{1} - \bar{X}_{2}) \pm \left(t^*_{\alpha/2} \times \sqrt{\frac{s_1^2}{n_1}+ \frac{s_2^2}{n_2} }\right),$$`
where `\(t^*_{\alpha/2}\)` is the **critical value** which (as before) is the upper `\(\left(1-\frac{\alpha}{2}\right)\%\)` **quantile** of a Student's T RV with `\(\nu\)` degrees of freedom.


**Q:** What is `\(\nu\)`? 


--
`$$\nu = \frac{\left(\frac{s_1^2}{n_1}+ \frac{s_2^2}{n_2} \right)^2}{\frac{1}{n_1-1}\left(\frac{s_1^2}{n_1}\right)^2 + \frac{1}{n_2-1}\left(\frac{s_2^2}{n_2}\right)^2 }$$`
But don't worry, you won't need to calculate this because R does that for you behind the scenes!


---
## Confidence Intervals 
### Option 1: Un-paired samples 

.scroll-output[
Example: Suppose we are comparing the battery life (in minutes) of two different brands of AA batteries. 

## In R 


```r
#Define the observed data 
x1_obs &lt;- c(160, 200, 205, 181, 190, 187, 172, 193, 182, 192)
x2_obs &lt;- c(212, 207, 198, 199, 208, 209, 192, 207)
#Then use the t.test() function 
t.test(x1_obs, x2_obs, paired=FALSE, conf.level=0.95)$conf.int
```

```
## [1] -28.155691  -7.444309
## attr(,"conf.level")
## [1] 0.95
```


## Interpretation 

We are `\(95\%\)` confident that the true difference between battery life between these two brands is
-28.16 and -7.44. Since this interval lies entirely below zero, this data does provides **statistical** evidence that there is a significant difference in the two brands' average battery life. ]



---
## Hypothesis tests 
### Option 1: Un-paired samples 

First determine what significance level you want to use! To be consistent with the confidence interval we just calculated, we're going to set `\(\alpha=0.05\)`. 


As it was with testing the difference in proportions, when comparing two means we are mostly interested in whether or not these means are the same or if one is bigger than the other. In other words, we want to test the null versus one of these three alternatives:
`\begin{align}
H_0: \mu_1 - \mu_2 = 0 \quad\text{and}\quad &amp;H_A:  \mu_1 - \mu_2 &lt; 0 \\
      \text{ or }&amp;H_A:  \mu_1 - \mu_2 &gt; 0\\
      \text{ or }&amp;H_A:  \mu_1 - \mu_2 \neq 0.
\end{align}`

To calculate the test statistic for any of the above hypotheses we use 
`$$\text{Test Statistic} = \text{T-score} = \frac{\bar{X}_1 - \bar{X}_2}{\sqrt{\frac{s_1^2}{n_1}+\frac{s_2^2}{n_2}}}.$$`

---
## Hypothesis tests 
### Option 1: Un-paired samples 

.scroll-output[
## In R 

```r
#Define the observed data 
x1_obs &lt;- c(160, 200, 205, 181, 190, 187, 172, 193, 182, 192)
x2_obs &lt;- c(212, 207, 198, 199, 208, 209, 192, 207)
#Then use the t.test() function and specify the direction of your alternative
t.test(x1_obs, x2_obs, alternative="two.sided", paired=FALSE, conf.level=0.95)
```

```
## 
## 	Welch Two Sample t-test
## 
## data:  x1_obs and x2_obs
## t = -3.6861, df = 14.022, p-value = 0.002438
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -28.155691  -7.444309
## sample estimates:
## mean of x mean of y 
##     186.2     204.0
```

## Interpretation 

With a p-value of 0 and a significance level of `\(\alpha = 0.05\)`, we reject the null hypothesis in favor of the alternative. This data provides enough evidence to suggest there is a statistically significant difference between the two average battery brands' life-span.]
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9",
"navigation": {
"scroll": false
}
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
