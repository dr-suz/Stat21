---
title: "Class 23"
subtitle: "Statistical Methods II (Stat 021)"
author: "Suzanne Thornton"
institute: "Swarthmore College"
date: "For class on Tuesday, May 4, 2021 (updated: `r Sys.Date()`)"
output:
  xaringan::moon_reader:
 #   css: ["default", "assets/sydney-fonts.css", "assets/sydney.css"]
    self_contained: false # if true, fonts will be stored locally
#    includes:
 #     in_header: "assets/mathjax-equation-numbers.html"
    nature:
#      beforeInit: ["assets/remark-zoom.js", "https://platform.twitter.com/widgets.js"]
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      ratio: '16:9' # alternatives '16:9' or '4:3' or others e.g. 13:9
      navigation:
        scroll: false # disable slide transitions by scrolling
includes:
  in_header: mystyles.sty
---

```{r setup_pres, include=FALSE, echo=FALSE}
#devtools::install_github("ropenscilabs/icon")
#devtools::session_info('rmarkdown')

rm(list=ls())
library('tidyverse')
library('gridExtra')
library('broom')
library('cowplot')
library("RefManageR")
library("DT")

#setwd("~/Google Drive Swat/Swat docs/Stat 21/Class13_files")
#setwd("~/Drive/Swat docs/Stat 21/Class9_files")
options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(fig.path='Figs/',echo=TRUE, warning=FALSE, message=FALSE)
```

```{css, echo=FALSE}
pre {
  background: #FFBB33;
  max-width: 100%;
  overflow-x: scroll;
}

.scroll-output {
  height: 60%;
  overflow-y: scroll;
}

.scroll-small {
  height: 30%;
  overflow-y: scroll;
}
   
.red{color: #ce151e;}
.green{color: #26b421;}
.blue{color: #426EF0;}
```


# Agenda

Here's the agenda for today's class: 

- Group check-ins (5 mins)

- Quick lecture: statistical inference overview (10 mins)

- Interaction effects group work (15 mins)

- Review Test 2 common confusions (15 mins)

- Housekeeping items and announcements (5 mins)

---
# Tuesday check-in 

- Send me a screenshot of your check-in markers on Slack

- [Fill out the group roles for today's class](https://docs.google.com/spreadsheets/d/1d34JxqXQON6MyIEjN5ugkByCeTuGTTb_ovvPfSAca_g/edit?usp=sharing) 

```{r, echo=FALSE, fig.align='center', out.height=500}
knitr::include_graphics("Figs/feelings_wheel.jpg")
```


---
## About random variables 
### Sampling strategies 

"Research studies are usually carried out on sample of subjects rather than whole populations. The most challenging aspect of fieldwork is drawing a random sample from the target population to which the results of the study would be generalized. In actual practice, the task is so difficult that some sampling bias occurs in almost all studies to a lesser or greater degree. In order to assess the degree of this bias, the informed reader of medical literature should have some understanding of the population from which the sample was drawn. The ultimate decision on whether the results of a particular study can be generalized to a larger population depends on this understanding."

"Similarly, in inferential statistics, it is not enough to just describe the results in the sample. One has to critically appraise the real worth or representativeness of that particular sample."

“Statistics without tears: Populations and samples Amitav Banerjee, Suprakash Chaudhury” Industrial Psychiatry Journal 2010


---
## Statistical Inference
### Moving from the sample to the population 

"Note, in particular, that data should not be confused with random variables. Random variables live in the theoretical world. When we say things like, “Let us assume the data are normally distributed” and we proceed to make a statistical inference, we do not need to take these words literally as asserting that the data form a random sample. Instead, this kind of language is a convenient and familiar shorthand for the much weaker assertion that, for our specified purposes, the variability of the data is adequately consistent with variability that would occur in a random sample."

For confidence intervals and hypothesis tests "[we] are able to draw useful conclusions as long as our theoretical world is aligned well with the real world that produced the data."

Statistical Inference: The Big Picture. Robert E. Kass Statistical Science 2011


---
## About statistical inference 
## Moving from the sample to the population


```{r, echo=FALSE, fig.align='center', out.height=400}
knitr::include_graphics("Figs/Kass_inference.png")
```



Statistical Inference: The Big Picture. 
Robert E. Kass
Statistical Science 2011 



---
## Interpreting effect sizes 
### Group work (10 mins)

**Instructions:** With your group, use the code on the next slides to work through this the edited version of the Class 22 worksheet. (This is available in the Week 12 material on Moodle.) 

**For now, only do the questions associated with Model 1 and Model 2.** 

**Recorder** You will be sharing your screen with your group mates as you write the code to solve these questions. Then, share a screenshot of the worksheet and use your stylus to write out the estimated regression equations and work through the steps to answer the questions with your group. 

**Reporter** Make a copy of the worksheet and type your group's answers into your copy of the worksheet. Submit this to me (and your group mates) on Slack when there is one minute left and be prepared to discuss your answers with me when I visit your group.  

**Questioner** Be prepared to annotate the screen to highlight any areas where you have questions or are unclear about the reasoning to an answer. For each question, determine if the answer should be a numeric value or if it will depend on another variable? 


---
## Interpreting effect sizes 
### Group work 

```{r}
library("tidyverse")
mileage <- read_table2(url("http://www.swarthmore.edu/NatSci/sthornt1/DataFiles/mileage.txt"), 
                       skip=2, col_names = c("car", "mpg", "displacement", "weight", "transmission_type"), 
                       cols(transmission_type = col_factor())) %>% na.omit
## Note that transmission_type is already a factor! 
head(mileage)
```


---
## Interpreting effect sizes 
### Group work 

```{r}
mod1 <- lm(mpg ~ displacement + transmission_type, mileage)

mod2 <- lm(mpg ~ displacement + relevel(transmission_type, "M"), mileage)

mod3 <- lm(mpg ~ displacement + transmission_type + displacement*transmission_type, mileage)
```


---
## Interpreting effect sizes 
### Group work (5 mins)

**Instructions:** With your group, use the code on the next slide to work through this the edited version of the Class 22 worksheet. (This is available in the Week 12 material on Moodle.) 

**Now, complete the questions based on Model 3.** 

---
## Test 2 Review 

---
## Test 2  
### Problem 2 


The following information is based on performing a Tukey HSD pairwise comparison to determine where the greatest disparities in SAT scores occur. The plot below displays the adjusted p-values and the estimated differences from each pair-wise comparison. The corresponding output of the `TukeyHSD` function is show on the next page.  

Based on these pairwise comparisons, which differences in SAT scores are statistically significant? Which differences are practically significant? Why might these not be the same? 

---
## Test 2 
### Problem 2 

```{r echo=FALSE, out.height=400, fig.align='center'}
library('mosaic')
SAT_data <- read_table2(url("http://www.swarthmore.edu/NatSci/sthornt1/DataFiles/SAT_data2.txt"))
mod1 <- lm(SAT_score ~ factor(Income), SAT_data)
comparisons <- data.frame(TukeyHSD(mod1)$'factor(Income)')
ggplot(comparisons, aes(x=p.adj, y=diff)) + 
  geom_point() + 
  labs(main = "Plotting the results of the Tukey HSD comparisons", 
       x = "Adjusted P-values", y="Estimated difference in SAT scores")
```


---
## Test 2 
### Problem 2 

```{r}
TukeyHSD(mod1)
```

---
## Test 2 
### Problem 2 


|              | Statistical Difference | Practical Difference (of at least $200$ points)   | 
| ------------ | ---------------------- | ---------------------- |
| $\alpha=0.1$ | 160K-200K and < 20K   | 160K-200K and <20K      |
|              | 100K-120K and <20K    | 100K-120K and <20K      |
|              | 60K-80K and <20K      |  60K-80K and <20K       | 
| $\alpha=0.2$ | 100K-120K and 20K-40K |                         |
|              | 160K-200K and 20K-40K |  160K-200K and 20K-40K  |
|              |                       | 160K-200 and 140K-160K  |
|              |                       |    20K-40K and <20K     |
|              |                       | 160K-200K and 40K-60K   |
|              |                       |      >200K and <20K     |


These do not match in some cases because of the severely unbalanced samples sizes. 

---
## Test 2 
### Problem 2 


```{r}
SAT_data %>% count(factor(Income))
```

---
## Test 2 
### Problem 5a  


The following data were collected by a GPS watch worn by the runner of a four-mile course. Using heart rate measurements after each run, an analysis of the runner's post-exercise heart rate recovery provides an indication of cardiovascular fitness. We are interested in answering the question: is the speed of the run (in mph) related to the number of calories burned. 

```{r runOutput, echo=TRUE, eval=FALSE}
run_dat <- read_table2("http://www.swarthmore.edu/NatSci/sthornt1/DataFiles/Four-Mile-Run-data.txt")
summary(lm(calories~aveSpeed, run_dat))
```



---
## Test 2 
### Problem 5a  

```{r echo=FALSE}
run_dat <- read_table2("http://www.swarthmore.edu/NatSci/sthornt1/DataFiles/Four-Mile-Run-data.txt")
summary(lm(calories~aveSpeed, run_dat))
```


---
## Test 2 
### Problem 5a  

a) What is the estimate for the standard deviation of the number of calories burned based on this linear model?

**Solution:** $\hat{\sigma}=30.84$



---
## Test 2 
### Problem 5d 


d) What numbers in the R output above can help us determine if this model is a good fit for the data? Explain briefly. (There are at least two.)

**Solution:** Any of the following options are valid: 

  - R-squared; 

  - p-value of the F-test for model fit; 

  - p-value of the t-test for the significance of the predictor. 


---
### Announcements 

- Slack
  
  * I will be checking Slack every day this week from 1-1:30 pm EST 
  
  * If you have coding problems, use the #r-q-and-a channel and include
  
    - The code that is causing the error 
    
    - The error message 
  
  * Final check-in posted

- Office hours 

  * Th May 6 from 2-3 pm EST
  
  * M May 10 from 7:30-8:30 pm 
  
  * If you cannot make these and need an additional appointment, let me know 24 hrs in advance and I'll do my best to accommodate you 

---
### Announcements 

- Final Project 

  * Part 3 is due May 11th

  * Part 4 instructions will be posted this week 
  
- Test 3 

  * Released at 8am on May 13 
  
  * Due to Gradescope by 12pm on May 15th 
  
  * Same format and policies as Test 1 and 2 but it will be a bit longer

- Next class 

  * Building a MLR model 
  
  * HW bonus problems group work 
  
  * HW 8 group work
  
