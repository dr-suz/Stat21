---
title: "Stat 21 Test 2"
author:
- "Your name here"
date: "Due: April  9, 2020 by noon EST"
output:
  pdf_document: 
    toc: no
  header-includes:
    - \usepackage{booktabs}
    - \usepackage{longtable}
    - \usepackage{array}
    - \usepackage{multirow}
    - \usepackage{wrapfig}
    - \usepackage{float}
    - \usepackage{colortbl}
    - \usepackage{pdflscape}
    - \usepackage{tabu}
    - \usepackage{threeparttable}
    - \usepackage{threeparttablex}
    - \usepackage[normalem]{ulem}
    - \usepackage{makecell}
urlcolor: blue
---

```{asis, directions=TRUE}

This test is due on to be submitted on Gradescope on __April 9__ by __12:00pm EST__. Please use the `#test2_questions` channel on Slack to post any clairfication questions. Do not ask questions like "Is [this] the right answer?" 


You must submit your solutions as a single __PDF__ document uploaded to __Gradescope__. You may use R markdown to write up your solutions alone or you may use R markdown and hand-written solutions. __You must show all of your work__, including code input and output. Please make sure each problem is __clearly labeled__ and that any handwritten components (such as pictures or equations) are easily readable in the PDF document. You may want to use a service like CamScanner (https://www.camscanner.com/) to help you upload handwritten pages and Small PDF (https://smallpdf.com/merge-pdf) to merge multiple PDFs into a single document. 

You are permitted to reference all class material and use the internet (though I am not sure it will be very helpful). You are not permitted however, to get assistance from any other person, online or otherwise.


+ Your file should contain the code to answer each question in its own code block. Your code should produce plots/output that will be automatically embedded in the output pdf file.
+ Each answer must be supported by written statements and relevant plots.
+ In order to knit this document, make sure you have installed the following packages in your version of RStudio: `ggplot2`, `tidyverse`, `gridExtra`, `knitr`
```


```{r setup, include=FALSE}
###########################
# DEFAULT SETTINGS
###########################
knitr::opts_chunk$set(message = FALSE) # include this if you don't want markdown to knit messages
knitr::opts_chunk$set(warning = FALSE) # include this if you don't want markdown to knit warnings
knitr::opts_chunk$set(echo=TRUE) # set echo=FALSE to hide code from html output
knitr::opts_chunk$set(fig.align='center') # center aligns images 
#knitr::opts_chunk$set(out.height=400) # sets the side of plots

###########################
# LIBRARIES
###########################
library(ggplot2)
library(tidyverse)
library(gridExtra)
#library(gcookbook)
library(knitr)
# the packages below are for formatting tables 
library(kableExtra)
```

\pagebreak


The table below is from an article titled "Class in America-2012" by Gregory Mantsios. This table shows the median combined SAT scores and the household income (broken into 10 categories) of 1,647,123 SAT-takers in the year 2010. The total scores represented in the table below are found by adding up the mean critical reading score, the mean mathematics score, and the mean writing scores for each income bracket of Table 11 on Pg 4 of the CollegeBoard report (linked in the footnotes).

| Income | Median SAT Score |
|--------|------------------|
| < \$20,000 | 1323  |
| \$20,000 - \$40,000 |  1398 |
| \$40,000 - \$60,000 |  1461 |
| \$60,000 - \$80,000 |  1503 |
| \$80,000 - \$100,000 |  1545 |
| \$100,000 - \$120,000 | 1580  |
| \$120,000 - \$140,000 | 1594  |
| \$140,000 - \$160,000 | 1619  |
| \$160,000 - \$200,000 | 1636  |
| $\geq$ \$200,000 | 1721  |


Based on this table, we may suspect that there is a relationship between SAT score and household income. Run the following lines of R code to import a data set consisting of a simple random sample of 100 students who took the SAT in 2010. (This sample was based on the data report by the College Board, feel free to talk to me about how I obtained this sample later![^1]) Use this data set to answer Problems 1-2. 

```{r echo=TRUE}
SAT_data <- read_table2(url("http://www.swarthmore.edu/NatSci/sthornt1/DataFiles/SAT_data2.txt"))
```


## Problem 1

State the null and alternative hypotheses for an ANOVA test of association between income and SAT scores. Comment on whether or not the necessary assumptions seem reasonable and justify your comments. Then perform the ANOVA test and interpret the results in the context of this data set. Show all your work and make sure you conclusion is statistically accurate and makes sense to a high-school student. 



\pagebreak 

## Problem 2

The following information is based on performing a Tukey HSD pairwise comparison to determine where the greatest disparities in SAT scores occur. The plot below displays the adjusted p-values and the estimated differences from each pair-wise comparison. The corresponding output of the `TukeyHSD` function is show on the next page.  

Based on these pairwise comparisions, which differences in SAT scores are statistically significant? Which differences are practically significant? Why might these not be the same? 


```{r echo=FALSE}
library('mosaic')
mod1 <- lm(SAT_score ~ factor(Income), SAT_data)
comparisons <- data.frame(TukeyHSD(mod1)$'factor(Income)')
ggplot(comparisons, aes(x=p.adj, y=diff)) + 
  geom_point() + 
  labs(main = "Plotting the results of the Tukey HSD comparisons", 
       x = "Adjusted P-values", y="Estimated difference in SAT scores")
```

\pagebreak 

```{r, echo=FALSE}
knitr::include_graphics("Figs/test2_table.png")
```

```{r echo=FALSE}
#comparisons
```


\pagebreak 

## Problem 3

For each of the four data sets below, write the estimated regression equation and plot the data and show the estimated regression line in the scatter plot. 

```{r}
data1 <- tibble(x= c(10,8,13,9,11,14,6,4,12,7,5), 
                y= c(8.04,6.95,7.58,8.81,8.33,9.96,7.24,4.26,10.84,4.82,5.68))
  
data2 <- tibble(x= c(10,8,13,9,11,14,6,4,12,7,5), 
                y= c(9.14,8.14,8.74,8.77,9.26,8.10,6.13,3.10,9.13,7.26,4.74))
  
data3 <- tibble(x= c(10,8,13,9,11,14,6,4,12,7,5), 
                y= c(7.46,6.77,12.74,7.11,7.81,8.84,6.08,5.39,8.15,6.42,5.73))
  
data4 <- tibble(x= c(8,8,8,8,8,8,8,8,8,8,19), 
                y= c(6.58,5.67,7.71,8.84,8.47,7.04,5.25,5.56,7.91,6.89,12.50))
```


Suppose we can assume that each of the four samples were independent draws from different populations. For which of the four data sets is the linear model appropriate? Justify your answer with statistical reasoning (possibly including additional plots). 




\pagebreak


## Problem 4

Suppose a professor has a paper titled: *Estimation and hypothesis testing in regression in the presence of nonhomogeneous error variances* lying out on her desk.[^3] In 1-2 sentences, explain what you think this paper is about. 




## Problem 5

The following data were collected by a GPS watch worn by the runner of a four-mile course. Using heart rate measurements after each run, an analysis of the runner's post-exercise heart rate recovery provides an indication of cardiovascular fitness. We are interested in answering the question: is the speed of the run (in mph) related to the number of calories burned. Below is the R code and output for fitting such a linear model to this data.[^4]  

```{r runOutput, echo=TRUE, warning=FALSE, message=FALSE}
run_dat <- read_table2(url(
              "http://www.swarthmore.edu/NatSci/sthornt1/DataFiles/Four-Mile-Run-data.txt"))
summary(lm(calories~aveSpeed, run_dat))
```


a) What is the estimate for the standard deviation of the number of calories burned based on this linear model?



b) On average, how many more (or fewer) calories can our runner expect to burn for each mph increase in average running speed? 



c) Suppose, on average, for any person within the same age group as our runner, every mph increase in running speed corresponds to $100$ additional calories burnt. How can we determine if our runner's rate of burning calories is different from this average for all people in the age group?  



d) What numbers in the R output above can help us determine if this model is a good fit for the data? Explain briefly. (There are at least two.)





[^1]: https://secure-media.collegeboard.org/digitalServices/pdf/research/2010-total-group-profile-report-cbs.pdf 

[^2]: https://www.census.gov/content/dam/Census/library/publications/2020/demo/p60-270.pdf

[^3]: Michael L. Deaton, Mation R. Reynolds Jr. & Raymond H. Myers (1983) Estimation and hypothesis testing in regression in the presence of nonhomogeneous error variances, Communications in Statistics - Simulation and Computation, 12:1, 45-66, DOI: 10.1080/03610918308812299 

[^4]: Paul J. Laumakis & Kevin McCormack (2014) Analyzing Exercise Training Effect and Its Impact on Cardiorespiratory and Cardiovascular Fitness, Journal of Statistics Education, 22:2, , DOI: 10.1080/10691898.2014.11889702]


\pagebreak 

## Bonus Problem

The [Undergraduate Class Project Competition (USCLAP)](https://www.causeweb.org/usproc/usclap) aims at class projects conducted by undergraduate students in their statistics and data sciences courses at the introductory or intermediate level. Project submissions are a short report/paper (up to 3 pages in length).

For +5 bonus points, read one of the five winning reports from the Intermediate Statsitics competition [here](https://www.causeweb.org/usproc/usclap/2020/spring/winners). In five sentences or less, summarize the statistical methods used in the report and comment on why you think this was a winning project. 
