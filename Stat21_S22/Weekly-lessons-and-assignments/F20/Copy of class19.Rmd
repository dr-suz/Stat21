---
title: "Class 19"
subtitle: "Statistical Methods II (Stat 021)"
author: "Suzanne Thornton"
institute: "Swarthmore College"
date: "For class on Tuesday, April 20, 2021 (updated: `r Sys.Date()`)"
output:
  xaringan::moon_reader:
 #   css: ["default", "assets/sydney-fonts.css", "assets/sydney.css"]
    self_contained: false # if true, fonts will be stored locally
#    includes:
 #     in_header: "assets/mathjax-equation-numbers.html"
    nature:
#      beforeInit: ["assets/remark-zoom.js", "https://platform.twitter.com/widgets.js"]
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      ratio: '16:9' # alternatives '16:9' or '4:3' or others e.g. 13:9
      navigation:
        scroll: false # disable slide transitions by scrolling
includes:
  in_header: mystyles.sty
---

```{r setup_pres, include=FALSE, echo=FALSE}
#devtools::install_github("ropenscilabs/icon")
#devtools::session_info('rmarkdown')

rm(list=ls())
library('tidyverse')
library('gridExtra')
library('broom')
library('cowplot')
library("RefManageR")
library("DT")

#setwd("~/Google Drive Swat/Swat docs/Stat 21/Class13_files")
#setwd("~/Drive/Swat docs/Stat 21/Class9_files")
options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(fig.path='Figs/',echo=TRUE, warning=FALSE, message=FALSE)
```

```{css, echo=FALSE}
pre {
  background: #FFBB33;
  max-width: 100%;
  overflow-x: scroll;
}

.scroll-output {
  height: 60%;
  overflow-y: scroll;
}

.scroll-small {
  height: 30%;
  overflow-y: scroll;
}
   
.red{color: #ce151e;}
.green{color: #26b421;}
.blue{color: #426EF0;}
```


# Agenda

Here's the agenda for today's class: 

- Group check-ins (5 mins)

- Discussion about Test 2 and Part 1 of your Final Project (15 mins)

- Homework 6 Problem 7 (15+ mins)

- Multiple linear regression (10 mins)

- Homework 7 (15+ mins)

- Housekeeping items and announcements (5 mins)

---
# Tuesday check-in 

- Send me a screenshot of your check-in markers on Slack

- [Fill out the group roles for today's class](https://docs.google.com/spreadsheets/d/1d34JxqXQON6MyIEjN5ugkByCeTuGTTb_ovvPfSAca_g/edit?usp=sharing) 

```{r, echo=FALSE, fig.align='center', out.height=500}
knitr::include_graphics("Figs/feelings_wheel.jpg")
```

---
## Discussion about Test 2 and Part 1 of your Final Project  


---
## Homework 6
### Problem 7 

The data shown below present the average number of surviving bacteria in a canned food product and the minutes of exposure to 300 degree Fahrenheit heat. Identify an appropriate transformed model for these data. 

.scroll-output[
```{r}
bacteria_data <- tibble(bacteria_count = c(175, 108, 95, 82, 71, 50, 49, 31, 28, 17, 16, 11),
                        minutes_exposure = c(1,2,3,4,5,6,7,8,9,10,11,12))
```
]


```{r echo=FALSE, eval=FALSE}

ggplot(mydata_all, aes(x=minutes_exposure, y=bacteria_count)) + 
  geom_point() + 
  labs(title="Scatter plot of data",
       y='Counts',
       x='Minutes')
```

---
## Homework 6
### Problem 7 

.scroll-output[
(a) Fit a SLR model to the transformed data and display the residual plot and calculate the coefficient of determination to comment on the adequacy of this model.

```{r}
bacteria_data2 <- bacteria_data %>% mutate(log_count = log(bacteria_count))
mod <- lm(log_count ~ minutes_exposure, bacteria_data2)
summary(mod)

mydata_all <- bacteria_data2 %>% mutate(mod_residuals = mod$residuals,
                                        mod_fitted = mod$fitted.values)

ggplot(mydata_all, aes(x=mod_fitted, y=mod_residuals)) + 
  geom_point() + 
  labs(title="Residual plot",
       y='Residuals',
       x='Fitted Values')
```

The coefficient of determination is $0.9804$ (or $0.9822$ is also acceptable). The residual plot is shown below. With a coefficient of determination so close to one and with a residual plot that shows evenly scattered residuals, without any discernible pattern or funneling, we conclude that the linear model is appropriate for this transformed data.] 

---
## Homework 6
### Problem 7 



(b) What is the average effect on the bacterial growth per each additional minute of exposure? 

The average effect on the *logarithm* of bacterial growth per each additional minute of exposure is $-0.236$. This means that the average effect on bacterial growth is $e^{-0.236}=0.790$ since $ln(a) = b$ is equivalent to $a = e^{b}$, where $e$ is Euler's number and $ln$ is the natural logarithm (i.e. $log$ base $e$). Therefore, if $-0.236$ is the amount that the natural logarithm of the counts changes for an increase in time, then $e^{-0.236}=0.790$ is the amount that the counts of bacteria change for an increase in time. 



--
**Q:** What can you do if you need more support going over the solutions to these homework problems? 


--
**A:** Come to office hours!!  

  * If you are struggling to keep up with the homework or projects, please make use of this time! 
  
  * I can help you debug R issues and we can work through homework questions together. 


---
# Multiple linear regression (MLR)

General model for $p$ predictor variables

$$Y \mid (x_1, x_2, \dots, x_p) = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \cdots + \beta_p x_p + \epsilon$$

where the following assumptions are made about the random noise, $\epsilon$

  - $E(\epsilon)=0$ and more importantly, $Var(\epsilon)=\sigma^2$;
  
  - All errors are independent of one another; 
  
  - The error is normally distributed (only necessary for *inference*). 

---
# Multiple linear regression (MLR)

## Measuring the model adequacy 

  - Overall F-test 

  - Adjusted R-squared 

  - (Standardized) Residual Plot 
  
  
--
## Incorporating categorical predictors 

  - A one-way ANOVA model is really just a MLR model that has $k-1$ predictor variables! 
  
  - A categorical predictor variable with $k$ levels will require $k-1$ dummy/indicator variables to fully represent this variable in the regression model. 


---
# Multiple linear regression (MLR)
## Looking ahead to next week 

What are some potential issues with MLR models? 

  * Multicollinearity 
  
  * Hidden extrapolation 
  
How can we generalize these models even further? 

  * Incorporate interaction terms 
  
  * Fit higher-order polynomial terms 

---
# Homework 7 
## Problems 1-2

The director of admissions of a small college selected 120 students at random from the new freshman class in a study to determine whether a student's grade point average (GPA) at the end of the freshman year $(Y)$ can be predicted from the ACT test score $(X_1)$ and from a binary categorical indicator of whether or not the student had chosen a major field of concentration at the time their application was submitted. The categorical predictor variable is coded so that 
$$X_2 = \begin{cases}0, \quad \text{if the major field was undecided} \\ 1, \quad  \text{if the student had indicated a major field of concentration at the time of application} \end{cases}.$$

.scroll-small[
```{r}
library("tidyverse")
admissions <- read.csv(url(
              "http://www.swarthmore.edu/NatSci/sthornt1/DataFiles/admissions_data.csv"))
head(admissions)
```
]


---
# Homework 7 
## Problems 1-2

**Instructions:** With your group, answer the following questions about a MLR fit to this data. Hand in either a screenshot of your answers or the text for your answers to me in a group Slack message. Make sure to mark your progress in the [Group Progress Checker](https://docs.google.com/spreadsheets/d/1d34JxqXQON6MyIEjN5ugkByCeTuGTTb_ovvPfSAca_g/edit?usp=sharing). (Do not call me into your Zoom breakout room!)

**Problem 1:** Explain the interpretation of each of the regression model coefficients within the context of this data:
$$Y_i \mid x_{1,i}, x_{2,i} = \beta_0 + \beta_1 x_{1,i} + \beta_2 x_{2,i} + \epsilon_i,$$
where 
$$x_{2,i} = \begin{cases}0, \quad \text{if student i is undecided} \\ 1, \quad  \text{if student i indicated a major field of concentration at the time of application} \end{cases},$$
and $E(\epsilon_i)=0$, $Var(\epsilon_i) = \sigma^2$, and all the errors are independent. 


**Problem 2:** Fit the regression model from Problem 1 and state the estimated regression equation. 

---
### Planning ahead for next class  

- Prepare for Thursday's class 

  * Comprehension quiz for week 11 
  
  * Read through HW 7 
  
  * Read through the instructions for Part 2 of your Final Project

- Regarding your final project and test 3

  * You will automatically lose 10 points for every day your submission is late 
  
  * No exceptions! 


---
### Announcements 

**Math/Stat Department Dresden Memorial Lecture by Professor Sarah Koch** 

Sarah Koch is an Associate Professor of Mathematics at the University of Michigan. Her research combines topology, algebraic geometry, and complex analysis in the field of complex dynamics, at once an ancient field asking basic questions about what happens when you repeat an operation over and over, and at the same time, a very modern one, whose beautiful Julia and Mandelbrot sets are illustrated on many a screensaver today.

.scroll-small[
**Wednesday, April 21, 8:00-9:00pm** Dresden Lecture

What is the shape of a polynomial? 
We will work with the complex numbers and discuss how one might understand the geometry or "shape" of a given (complex) polynomial function. There will be many pictures and movies in this talk.

**Friday, April 23, 3:00-4:00pm** Dresden Presentation and Q&A

Math Circles: a bundle of outreach
One of my favorite parts of being a mathematician is sharing math with other people. I have been extensively involved in outreach since I arrived at the Michigan Math Department in 2013. I have led Math Circle sessions for middle schoolers, high schoolers, and math teachers. In 2018, I was on my way to Dearborn, Michigan to lead a Math Circle session with one of my colleagues. Something happened during that trip that changed my life. I would love to tell you about it!

**Friday, April 23, 4:10-4:40pm** AWM/W+iMS Virtual Tea with Speaker
]

Zoom Link for Dresden Lecture/Presentation and Q&A https://swarthmore.zoom.us/j/92417771543 

This event will be recorded and posted on Math/Stat Dept. 2020-2021 Colloquium Schedule   