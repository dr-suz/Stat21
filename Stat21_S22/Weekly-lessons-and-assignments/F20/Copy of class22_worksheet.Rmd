---
title: "Stat 021 S 21"
author: "Class 22 Worksheet"
output:
  pdf_document: 
    toc: no
urlcolor: blue
---

## Instructions: 

Use the data below to answer the following questions for each of the three models specified. 

```{r}
library("tidyverse")
mileage <- read_table2(url("http://www.swarthmore.edu/NatSci/sthornt1/DataFiles/mileage.txt"), 
      skip=2, col_names = c("car", "mpg", "displacement", "weight", "transmission_type"), 
      cols(transmission_type = col_factor())) %>% na.omit
## Note that transmission_type is already a factor! 
head(mileage)
```
 
 \pagebreak
 
## Model 1

### Fit a main effects model with transmission type (A as the reference level) and displacement as the predictors and mileage as the response:


$$\hat{y} = \hat{\beta}_0 + \hat{\beta}_1 * \text{displacement} + \hat{\beta}_2 * \text{transmission\_typeM},$$

where $displacement=$ the displacement of the engine and 
$$\text{transmission\_typeM} = \begin{cases}1, \quad \text{if transmission type is manual}\\ 0, \quad \text{otherwise} \end{cases}.$$


```{r}
mod1 <- lm(mpg ~ displacement + transmission_type, mileage)
summary(mod1)
```

  
1. What is the average effect on gasoline mileage when we go from a car with an automatic transmission to a manual transmission?

&nbsp;
&nbsp;
&nbsp;
&nbsp;

2. What is the average effect on gasoline mileage when we go from a car with an manual transmission to an automatic transmission?

&nbsp;
&nbsp;
&nbsp;
&nbsp;

3. What is the average effect of engine displacement on gasoline mileage?   

&nbsp;
&nbsp;
&nbsp;
&nbsp;

4. What is the average effect of engine displacement on gasoline mileage when we go from a car with an manual transmission to an automatic transmission?

&nbsp;
&nbsp;
&nbsp;
&nbsp;

5. What is the average effect of vehicle weight on gasoline mileage when we go from a car with an automatic transmission to a manual transmission?

&nbsp;
&nbsp;
&nbsp;
&nbsp;

 
 \pagebreak

## Model 2

### Fit a main effects model with transmission type (M as the reference level) and displacement as the predictors and mileage as the response:

$$\hat{y} = \hat{\beta}_0 + \hat{\beta}_1 * \text{displacement} + \hat{\beta}_2 * \text{transmission\_typeA},$$
  where $displacement=$ the displacement of the engine and 
$$\text{transmission\_typeA} = \begin{cases}1, \quad \text{if transmission type is automatic}\\ 0, \quad \text{otherwise} \end{cases}.$$


```{r}
mod2 <- lm(mpg ~ displacement + relevel(transmission_type, "M"), mileage)
summary(mod2)
```

    
1. What is the average effect on gasoline mileage when we go from a car with an automatic transmission to a manual transmission?

&nbsp;
&nbsp;
&nbsp;
&nbsp;

2. What is the average effect on gasoline mileage when we go from a car with an manual transmission to an automatic transmission?

&nbsp;
&nbsp;
&nbsp;
&nbsp;

3. What is the average effect of engine displacement on gasoline mileage?   

&nbsp;
&nbsp;
&nbsp;
&nbsp;

4. What is the average effect of engine displacement on gasoline mileage when we go from a car with an manual transmission to an automatic transmission?

&nbsp;
&nbsp;
&nbsp;
&nbsp;

5. What is the average effect of vehicle weight on gasoline mileage when we go from a car with an automatic transmission to a manual transmission?

&nbsp;
&nbsp;
&nbsp;
&nbsp;


 
\pagebreak

## Model 3

### Fit an interaction effects model with transmission type (A as the reference level) and displacement as the predictors and mileage as the response:

$$\hat{y} = \hat{\beta}_0 + (\hat{\beta}_1 * \text{displacement}) + (\hat{\beta}_2 * \text{transmission\_typeM}) + (\hat{\beta}_4 * \text{displacement} * \text{transmission\_typeM}),$$
  where $displacement=$ the displacement of the engine and 
$$\text{transmission\_typeM} = \begin{cases}1, \quad \text{if transmission type is manual}\\ 0, \quad \text{otherwise} \end{cases}.$$

```{r}
mod3 <- lm(mpg ~ displacement + transmission_type + displacement*transmission_type, mileage)
summary(mod3)
```
  
1. What is the average effect on gasoline mileage when we go from a car with an automatic transmission to a manual transmission?

&nbsp;
&nbsp;
&nbsp;
&nbsp;

2. What is the average effect on gasoline mileage when we go from a car with an manual transmission to an automatic transmission?

&nbsp;
&nbsp;
&nbsp;
&nbsp;

3. What is the average effect of engine displacement on gasoline mileage?   

&nbsp;
&nbsp;
&nbsp;
&nbsp;

4. What is the average effect of engine displacement on gasoline mileage when we go from a car with an manual transmission to an automatic transmission?

&nbsp;
&nbsp;
&nbsp;
&nbsp;

5. What is the average effect of vehicle weight on gasoline mileage when we go from a car with an automatic transmission to a manual transmission?

&nbsp;
&nbsp;
&nbsp;
&nbsp;